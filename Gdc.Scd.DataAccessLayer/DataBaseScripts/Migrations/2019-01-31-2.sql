declare @y1 bigint;
declare @y2 bigint;
declare @y3 bigint;
declare @y4 bigint;
declare @y5 bigint;

select @y1 = id from Dependencies.Year where Value = 1 and IsProlongation = 0;
select @y2 = id from Dependencies.Year where Value = 2 and IsProlongation = 0;
select @y3 = id from Dependencies.Year where Value = 3 and IsProlongation = 0;
select @y4 = id from Dependencies.Year where Value = 4 and IsProlongation = 0;
select @y5 = id from Dependencies.Year where Value = 5 and IsProlongation = 0;

with HddCte as (
    select *
    from (values
              (('C71'), (1), (25.000), (200.00         )) 
            , (('C71'), (2), (25.000), (200.00         ))
            , (('C71'), (4), (25.000), (200.00         ))
            , (('C71'), (5), (25.000), (200.00         ))
            , (('C71'), (3), (25.000), (200.00         ))
            , (('C73'), (1), (18.000), (280.00         ))
            , (('C73'), (2), (18.000), (280.00         ))
            , (('C73'), (3), (18.000), (280.00         ))
            , (('C73'), (4), (18.000), (280.00         ))
            , (('C73'), (5), (18.000), (280.00         ))
            , (('C74'), (1), (28.800), (276.00         ))
            , (('C74'), (2), (28.800), (276.00         ))
            , (('C74'), (3), (28.800), (276.00         ))
            , (('C74'), (4), (28.800), (276.00         ))
            , (('C74'), (5), (28.800), (276.00         ))
            , (('C75'), (1), (28.800), (276.00         ))
            , (('C75'), (2), (28.800), (276.00         ))
            , (('C75'), (3), (28.800), (276.00         ))
            , (('C75'), (4), (28.800), (276.00         ))
            , (('C75'), (5), (28.800), (276.00         ))
            , (('C80'), (1), (34.000), (260.00         ))
            , (('C80'), (2), (34.000), (260.00         ))
            , (('C80'), (3), (34.000), (260.00         ))
            , (('C80'), (4), (34.000), (260.00         ))
            , (('C80'), (5), (34.000), (260.00         ))
            , (('C84'), (1), (20.000), (205.00         ))
            , (('C84'), (2), (20.000), (205.00         ))
            , (('C84'), (3), (20.000), (205.00         ))
            , (('C84'), (4), (20.000), (205.00         ))
            , (('C84'), (5), (20.000), (205.00         ))
            , (('C96'), (1), (4.000), (175.00          ))
            , (('C96'), (2), (4.000), (175.00          ))
            , (('C96'), (3), (4.000), (175.00          ))
            , (('C96'), (4), (4.000), (175.00          ))
            , (('C96'), (5), (4.000), (175.00          ))
            , (('C97'), (1), (17.000), (200.00         ))
            , (('C97'), (2), (17.000), (200.00         ))
            , (('C97'), (3), (17.000), (200.00         ))
            , (('C97'), (4), (17.000), (200.00         ))
            , (('C97'), (5), (17.000), (200.00         ))
            , (('C98'), (1), (17.000), (200.00         ))
            , (('C98'), (2), (17.000), (200.00         ))
            , (('C98'), (3), (17.000), (200.00         ))
            , (('C98'), (4), (17.000), (200.00         ))
            , (('C98'), (5), (17.000), (200.00         ))
            , (('CD5'), (1), (90.000), (294.15         ))
            , (('CD5'), (2), (90.000), (294.15         ))
            , (('CD5'), (3), (90.000), (294.15         ))
            , (('CD5'), (4), (90.000), (294.15         ))
            , (('CD5'), (5), (90.000), (294.15         ))
            , (('CD6'), (1), (14.400), (310.00         ))
            , (('CD6'), (2), (14.400), (310.00         ))
            , (('CD6'), (3), (14.400), (310.00         ))
            , (('CD6'), (4), (14.400), (310.00         ))
            , (('CD6'), (5), (14.400), (310.00         ))
            , (('CD7'), (1), (14.300), (290.00         ))
            , (('CD7'), (2), (14.300), (290.00         ))
            , (('CD7'), (3), (14.300), (290.00         ))
            , (('CD7'), (4), (14.300), (290.00         ))
            , (('CD7'), (5), (14.300), (290.00         ))
            , (('CD8'), (1), (2.400), (300.00          ))
            , (('CD8'), (2), (2.400), (300.00          ))
            , (('CD8'), (3), (2.400), (300.00          ))
            , (('CD8'), (4), (2.400), (300.00          ))
            , (('CD8'), (5), (2.400), (300.00          ))
            , (('CD9'), (1), (2.400), (300.00          ))
            , (('CD9'), (2), (2.400), (300.00          ))
            , (('CD9'), (3), (2.400), (300.00          ))
            , (('CD9'), (4), (2.400), (300.00          ))
            , (('CD9'), (5), (2.400), (300.00          ))
            , (('CS4'), (1), (13.200), (250.00         ))
            , (('CS4'), (2), (13.200), (250.00         ))
            , (('CS4'), (3), (13.200), (250.00         ))
            , (('CS4'), (4), (13.200), (250.00         ))
            , (('CS4'), (5), (13.200), (250.00         ))
            , (('CS6'), (1), (28.800), (257.00         ))
            , (('CS6'), (2), (28.800), (257.00         ))
            , (('CS6'), (3), (28.800), (257.00         ))
            , (('CS6'), (4), (28.800), (257.00         ))
            , (('CS6'), (5), (28.800), (257.00         ))
            , (('CS7'), (1), (28.800), (257.00         ))
            , (('CS7'), (2), (28.800), (257.00         ))
            , (('CS7'), (3), (28.800), (257.00         ))
            , (('CS7'), (4), (28.800), (257.00         ))
            , (('CS7'), (5), (28.800), (257.00         ))
            , (('CS8'), (1), (2.200), (236.00          ))
            , (('CS8'), (2), (2.200), (236.00          ))
            , (('CS8'), (3), (2.200), (236.00          ))
            , (('CS8'), (4), (2.200), (236.00          ))
            , (('CS8'), (5), (2.200), (236.00          ))
            , (('CS9'), (1), (80.000), (325.00         ))
            , (('CS9'), (2), (80.000), (325.00         ))
            , (('CS9'), (3), (80.000), (325.00         ))
            , (('CS9'), (4), (80.000), (325.00         ))
            , (('CS9'), (5), (80.000), (325.00         ))
            , (('F28'), (1), (24.000), (275.00         ))
            , (('F28'), (2), (24.000), (275.00         ))
            , (('F28'), (3), (24.000), (275.00         ))
            , (('F28'), (4), (24.000), (275.00         ))
            , (('F28'), (5), (24.000), (275.00         ))
            , (('F29'), (1), (24.000), (275.00         ))
            , (('F29'), (2), (24.000), (275.00         ))
            , (('F29'), (3), (24.000), (275.00         ))
            , (('F29'), (4), (24.000), (275.00         ))
            , (('F29'), (5), (24.000), (275.00         ))
            , (('F40'), (1), (12.000), (325.00         ))
            , (('F40'), (2), (12.000), (325.00         ))
            , (('F40'), (3), (12.000), (325.00         ))
            , (('F40'), (4), (12.000), (325.00         ))
            , (('F40'), (5), (12.000), (325.00         ))
            , (('F41'), (1), (80.000), (325.00         ))
            , (('F41'), (2), (80.000), (325.00         ))
            , (('F41'), (4), (80.000), (325.00         ))
            , (('F41'), (5), (80.000), (325.00         ))
            , (('F41'), (3), (80.000), (325.00         ))
            , (('F42'), (1), (17.000), (325.00         ))
            , (('F42'), (2), (17.000), (325.00         ))
            , (('F42'), (3), (17.000), (325.00         ))
            , (('F42'), (4), (17.000), (325.00         ))
            , (('F42'), (5), (17.000), (325.00         ))
            , (('F43'), (1), (17.000), (325.00         ))
            , (('F43'), (2), (17.000), (325.00         ))
            , (('F43'), (3), (17.000), (325.00         ))
            , (('F43'), (4), (17.000), (325.00         ))
            , (('F43'), (5), (17.000), (325.00         ))
            , (('F44'), (1), (17.000), (325.00         ))
            , (('F44'), (2), (17.000), (325.00         ))
            , (('F44'), (3), (17.000), (325.00         ))
            , (('F44'), (4), (17.000), (325.00         ))
            , (('F44'), (5), (17.000), (325.00         ))
            , (('F45'), (1), (17.000), (325.00         ))
            , (('F45'), (2), (17.000), (325.00         ))
            , (('F45'), (3), (17.000), (325.00         ))
            , (('F45'), (4), (17.000), (325.00         ))
            , (('F45'), (5), (17.000), (325.00         ))
            , (('F48'), (1), (12.000), (325.00         ))
            , (('F48'), (2), (12.000), (325.00         ))
            , (('F48'), (3), (12.000), (325.00         ))
            , (('F48'), (4), (12.000), (325.00         ))
            , (('F48'), (5), (12.000), (325.00         ))
            , (('F49'), (1), (80.000), (325.00         ))
            , (('F49'), (2), (80.000), (325.00         ))
            , (('F49'), (3), (80.000), (325.00         ))
            , (('F49'), (4), (80.000), (325.00         ))
            , (('F49'), (5), (80.000), (325.00         ))
            , (('F50'), (1), (18.000), (291.00         ))
            , (('F50'), (2), (18.000), (291.00         ))
            , (('F50'), (3), (18.000), (291.00         ))
            , (('F50'), (4), (18.000), (291.00         ))
            , (('F50'), (5), (18.000), (291.00         ))
            , (('F51'), (1), (17.000), (325.00         ))
            , (('F51'), (2), (17.000), (325.00         ))
            , (('F51'), (3), (17.000), (325.00         ))
            , (('F51'), (4), (17.000), (325.00         ))
            , (('F51'), (5), (17.000), (325.00         ))
            , (('F52'), (1), (17.000), (325.00         ))
            , (('F52'), (2), (17.000), (325.00         ))
            , (('F52'), (3), (17.000), (325.00         ))
            , (('F52'), (4), (17.000), (325.00         ))
            , (('F52'), (5), (17.000), (325.00         ))
            , (('F53'), (1), (17.000), (200.00         ))
            , (('F53'), (2), (17.000), (200.00         ))
            , (('F53'), (3), (17.000), (200.00         ))
            , (('F53'), (4), (17.000), (200.00         ))
            , (('F53'), (5), (17.000), (200.00         ))
            , (('F54'), (1), (17.000), (200.00         ))
            , (('F54'), (2), (17.000), (200.00         ))
            , (('F54'), (3), (17.000), (200.00         ))
            , (('F54'), (4), (17.000), (200.00         ))
            , (('F54'), (5), (17.000), (200.00         ))
            , (('F57'), (1), (18.000), (291.00         ))
            , (('F57'), (2), (18.000), (291.00         ))
            , (('F57'), (3), (18.000), (291.00         ))
            , (('F57'), (4), (18.000), (291.00         ))
            , (('F57'), (5), (18.000), (291.00         ))
            , (('MN2'), (1), (9.000), (185.00          ))
            , (('MN2'), (2), (9.000), (185.00          ))
            , (('MN2'), (3), (9.000), (185.00          ))
            , (('MN2'), (4), (9.000), (185.00          ))
            , (('MN2'), (5), (9.000), (185.00          ))
            , (('MN3'), (1), (1.600), (250.00          ))
            , (('MN3'), (2), (1.600), (250.00          ))
            , (('MN3'), (3), (1.600), (250.00          ))
            , (('MN3'), (4), (1.600), (250.00          ))
            , (('MN3'), (5), (1.600), (250.00          ))
            , (('NB1'), (1), (0.600), (125.00          ))
            , (('NB1'), (2), (0.600), (125.00          ))
            , (('NB1'), (3), (0.600), (125.00          ))
            , (('NB1'), (4), (0.600), (125.00          ))
            , (('NB1'), (5), (0.600), (125.00          ))
            , (('NB2'), (1), (0.420), (115.00          ))
            , (('NB2'), (2), (0.420), (115.00          ))
            , (('NB2'), (3), (0.420), (115.00          ))
            , (('NB2'), (4), (0.420), (115.00          ))
            , (('NB2'), (5), (0.420), (115.00          ))
            , (('NB5'), (1), (1.100), (110.00          ))
            , (('NB5'), (2), (1.100), (110.00          ))
            , (('NB5'), (3), (1.100), (110.00          ))
            , (('NB5'), (4), (1.100), (110.00          ))
            , (('NB5'), (5), (1.100), (110.00          ))
            , (('NB6'), (1), (0.650), (69.00           ))
            , (('NB6'), (2), (0.650), (69.00           ))
            , (('NB6'), (3), (0.650), (69.00           ))
            , (('NB6'), (4), (0.650), (69.00           ))
            , (('NB6'), (5), (0.650), (69.00           ))
            , (('NB7'), (1), (1.000), (83.00           ))
            , (('NB7'), (2), (1.000), (83.00           ))
            , (('NB7'), (3), (1.000), (83.00           ))
            , (('NB7'), (4), (1.000), (83.00           ))
            , (('NB7'), (5), (1.000), (83.00           ))
            , (('NC1'), (1), (0.420), (190.00          ))
            , (('NC1'), (2), (0.420), (190.00          ))
            , (('NC1'), (3), (0.420), (190.00          ))
            , (('NC1'), (4), (0.420), (190.00          ))
            , (('NC1'), (5), (0.420), (190.00          ))
            , (('NC3'), (1), (0.380), (168.00          ))
            , (('NC3'), (2), (0.380), (168.00          ))
            , (('NC3'), (3), (0.380), (168.00          ))
            , (('NC3'), (4), (0.380), (168.00          ))
            , (('NC3'), (5), (0.380), (168.00          ))
            , (('NC9'), (1), (0.200), (228.00          ))
            , (('NC9'), (2), (0.200), (228.00          ))
            , (('NC9'), (3), (0.200), (228.00          ))
            , (('NC9'), (4), (0.200), (228.00          ))
            , (('NC9'), (5), (0.200), (228.00          ))
            , (('ND3'), (1), (0.430), (130.00          ))
            , (('ND3'), (2), (0.430), (130.00          ))
            , (('ND3'), (3), (0.430), (130.00          ))
            , (('ND3'), (4), (0.430), (130.00          ))
            , (('ND3'), (5), (0.430), (130.00          ))
            , (('PQ0'), (1), (10.000), (747.00         ))
            , (('PQ0'), (2), (10.000), (747.00         ))
            , (('PQ0'), (3), (10.000), (747.00         ))
            , (('PQ0'), (4), (10.000), (747.00         ))
            , (('PQ0'), (5), (10.000), (747.00         ))
            , (('PQ5'), (1), (4.500), (350.00          ))
            , (('PQ5'), (2), (4.500), (350.00          ))
            , (('PQ5'), (3), (4.500), (350.00          ))
            , (('PQ5'), (4), (4.500), (350.00          ))
            , (('PQ5'), (5), (4.500), (350.00          ))
            , (('PQ9'), (1), (11.000), (688.00         ))
            , (('PQ9'), (2), (11.000), (688.00         ))
            , (('PQ9'), (3), (11.000), (688.00         ))
            , (('PQ9'), (4), (11.000), (688.00         ))
            , (('PQ9'), (5), (11.000), (688.00         ))
            , (('PX1'), (1), (1.600), (162.00          ))
            , (('PX1'), (2), (1.600), (162.00          ))
            , (('PX1'), (3), (1.600), (162.00          ))
            , (('PX1'), (4), (1.600), (162.00          ))
            , (('PX1'), (5), (1.600), (162.00          ))
            , (('PX2'), (1), (2.000), (210.00          ))
            , (('PX2'), (2), (2.000), (210.00          ))
            , (('PX2'), (3), (2.000), (210.00          ))
            , (('PX2'), (4), (2.000), (210.00          ))
            , (('PX2'), (5), (2.000), (210.00          ))
            , (('PX3'), (1), (3.500), (210.00          ))
            , (('PX3'), (2), (3.500), (210.00          ))
            , (('PX3'), (3), (3.500), (210.00          ))
            , (('PX3'), (4), (3.500), (210.00          ))
            , (('PX3'), (5), (3.500), (210.00          ))
            , (('PX6'), (1), (5.000), (220.00          ))
            , (('PX6'), (2), (5.000), (220.00          ))
            , (('PX6'), (3), (5.000), (220.00          ))
            , (('PX6'), (4), (5.000), (220.00          ))
            , (('PX6'), (5), (5.000), (220.00          ))
            , (('PX8'), (1), (7.510), (235.00          ))
            , (('PX8'), (2), (7.510), (235.00          ))
            , (('PX8'), (3), (7.510), (235.00          ))
            , (('PX8'), (4), (7.510), (235.00          ))
            , (('PX8'), (5), (7.510), (235.00          ))
            , (('PXS'), (1), (2.100), (180.00          ))
            , (('PXS'), (2), (2.100), (180.00          ))
            , (('PXS'), (3), (2.100), (180.00          ))
            , (('PXS'), (4), (2.100), (180.00          ))
            , (('PXS'), (5), (2.100), (180.00          ))
            , (('PY1'), (1), (3.000), (170.00          ))
            , (('PY1'), (2), (3.000), (170.00          ))
            , (('PY1'), (3), (3.000), (170.00          ))
            , (('PY1'), (4), (3.000), (170.00          ))
            , (('PY1'), (5), (3.000), (170.00          ))
            , (('PY2'), (1), (5.500), (195.00          ))
            , (('PY2'), (2), (5.500), (195.00          ))
            , (('PY2'), (3), (5.500), (195.00          ))
            , (('PY2'), (4), (5.500), (195.00          ))
            , (('PY2'), (5), (5.500), (195.00          ))
            , (('PY3'), (1), (11.000), (235.00         ))
            , (('PY3'), (2), (11.000), (235.00         ))
            , (('PY3'), (3), (11.000), (235.00         ))
            , (('PY3'), (4), (11.000), (235.00         ))
            , (('PY3'), (5), (11.000), (235.00         ))
            , (('PY4'), (1), (3.500), (175.00          ))
            , (('PY4'), (2), (3.500), (175.00          ))
            , (('PY4'), (3), (3.500), (175.00          ))
            , (('PY4'), (4), (3.500), (175.00          ))
            , (('PY4'), (5), (3.500), (175.00          ))
            , (('RB0'), (1), (0.300), (75.00           ))
            , (('RB0'), (2), (0.300), (75.00           ))
            , (('RB0'), (3), (0.300), (75.00           ))
            , (('RB0'), (4), (0.300), (75.00           ))
            , (('RB0'), (5), (0.300), (75.00           ))
            , (('SB2'), (1), (3.000), (150.00          ))
            , (('SB2'), (2), (3.000), (150.00          ))
            , (('SB2'), (3), (3.000), (150.00          ))
            , (('SB2'), (4), (3.000), (150.00          ))
            , (('SB2'), (5), (3.000), (150.00          ))
            , (('SB3'), (1), (4.000), (165.00          ))
            , (('SB3'), (2), (4.000), (165.00          ))
            , (('SB3'), (3), (4.000), (165.00          ))
            , (('SB3'), (4), (4.000), (165.00          ))
            , (('SB3'), (5), (4.000), (165.00          ))
            , (('TR7'), (1), (0.200), (300.00          ))
            , (('TR7'), (2), (0.200), (300.00          ))
            , (('TR7'), (3), (0.200), (300.00          ))
            , (('TR7'), (4), (0.200), (300.00          ))
            , (('TR7'), (5), (0.200), (300.00          ))
            , (('U02'), (1), (0.260), (77.00           ))
            , (('U02'), (2), (0.260), (77.00           ))
            , (('U02'), (3), (0.260), (77.00           ))
            , (('U02'), (4), (0.260), (77.00           ))
            , (('U02'), (5), (0.260), (77.00           ))
            , (('U03'), (1), (0.380), (80.00           ))
            , (('U03'), (2), (0.380), (80.00           ))
            , (('U03'), (3), (0.380), (80.00           ))
            , (('U03'), (4), (0.380), (80.00           ))
            , (('U03'), (5), (0.380), (80.00           ))
            , (('U04'), (1), (0.600), (89.00           ))
            , (('U04'), (2), (0.600), (89.00           ))
            , (('U04'), (3), (0.600), (89.00           ))
            , (('U04'), (4), (0.600), (89.00           ))
            , (('U04'), (5), (0.600), (89.00           ))
            , (('U06'), (1), (0.320), (80.00           ))
            , (('U06'), (2), (0.320), (80.00           ))
            , (('U06'), (3), (0.320), (80.00           ))
            , (('U06'), (4), (0.320), (80.00           ))
            , (('U06'), (5), (0.320), (80.00           ))
            , (('U07'), (1), (0.700), (74.00           ))
            , (('U07'), (2), (0.700), (74.00           ))
            , (('U07'), (3), (0.700), (74.00           ))
            , (('U07'), (4), (0.700), (74.00           ))
            , (('U07'), (5), (0.700), (74.00           ))
            , (('U08'), (1), (0.530), (100.00          ))
            , (('U08'), (2), (0.530), (100.00          ))
            , (('U08'), (3), (0.530), (100.00          ))
            , (('U08'), (4), (0.530), (100.00          ))
            , (('U08'), (5), (0.530), (100.00          ))
            , (('U09'), (1), (0.700), (65.00           ))
            , (('U09'), (2), (0.700), (65.00           ))
            , (('U09'), (3), (0.700), (65.00           ))
            , (('U09'), (4), (0.700), (65.00           ))
            , (('U09'), (5), (0.700), (65.00           ))
            , (('U10'), (1), (0.350), (75.00           ))
            , (('U10'), (2), (0.350), (75.00           ))
            , (('U10'), (3), (0.350), (75.00           ))
            , (('U10'), (4), (0.350), (75.00           ))
            , (('U10'), (5), (0.350), (75.00           ))
            , (('U11'), (1), (0.500), (73.00           ))
            , (('U11'), (2), (0.500), (73.00           ))
            , (('U11'), (3), (0.500), (73.00           ))
            , (('U11'), (4), (0.500), (73.00           ))
            , (('U11'), (5), (0.500), (73.00           ))
            , (('U12'), (1), (0.260), (77.00           ))
            , (('U12'), (2), (0.260), (77.00           ))
            , (('U12'), (3), (0.260), (77.00           ))
            , (('U12'), (4), (0.260), (77.00           ))
            , (('U12'), (5), (0.260), (77.00           ))
            , (('U13'), (1), (0.240), (92.00           ))
            , (('U13'), (5), (0.240), (92.00           ))
            , (('U13'), (4), (0.240), (92.00           ))
            , (('U13'), (2), (0.240), (92.00           ))
            , (('U13'), (3), (0.240), (92.00           ))
            , (('W01'), (1), (0.600), (180.00          ))
            , (('W01'), (2), (0.600), (180.00          ))
            , (('W01'), (3), (0.600), (180.00          ))
            , (('W01'), (4), (0.600), (180.00          ))
            , (('W01'), (5), (0.600), (180.00          ))
            , (('WRC'), (1), (0.550), (100.00          ))
            , (('WRC'), (2), (0.550), (100.00          ))
            , (('WRC'), (3), (0.550), (100.00          ))
            , (('WRC'), (4), (0.550), (100.00          ))
            , (('WRC'), (5), (0.550), (100.00          ))
            , (('WSJ'), (1), (0.300), (138.00          ))
            , (('WSJ'), (2), (0.300), (138.00          ))
            , (('WSJ'), (3), (0.300), (138.00          ))
            , (('WSJ'), (4), (0.300), (138.00          ))
            , (('WSJ'), (5), (0.300), (138.00          ))
            , (('WSN'), (1), (0.450), (125.00          ))
            , (('WSN'), (2), (0.450), (125.00          ))
            , (('WSN'), (3), (0.450), (125.00          ))
            , (('WSN'), (4), (0.450), (125.00          ))
            , (('WSN'), (5), (0.450), (125.00          ))
            , (('WSS'), (1), (0.900), (145.00          ))
            , (('WSS'), (2), (0.900), (145.00          ))
            , (('WSS'), (3), (0.900), (145.00          ))
            , (('WSS'), (4), (0.900), (145.00          ))
            , (('WSS'), (5), (0.900), (145.00          ))
            , (('WSW'), (1), (0.550), (105.00          ))
            , (('WSW'), (2), (0.550), (105.00          ))
            , (('WSW'), (3), (0.550), (105.00          ))
            , (('WSW'), (4), (0.550), (105.00          ))
            , (('WSW'), (5), (0.550), (105.00          ))
            , (('Y03'), (1), (0.500), (260.00          ))
            , (('Y03'), (2), (0.500), (260.00          ))
            , (('Y03'), (3), (0.500), (260.00          ))
            , (('Y03'), (4), (0.500), (260.00          ))
            , (('Y03'), (5), (0.500), (260.00          ))
            , (('Y09'), (1), (1.500), (170.00          ))
            , (('Y09'), (2), (1.500), (170.00          ))
            , (('Y09'), (3), (1.500), (170.00          ))
            , (('Y09'), (4), (1.500), (170.00          ))
            , (('Y09'), (5), (1.500), (170.00          ))
            , (('Y12'), (1), (0.600), (115.00          ))
            , (('Y12'), (2), (0.600), (115.00          ))
            , (('Y12'), (3), (0.600), (115.00          ))
            , (('Y12'), (4), (0.600), (115.00          ))
            , (('Y12'), (5), (0.600), (115.00          ))
            , (('Y17'), (1), (12.000), (223.00         ))
            , (('Y17'), (2), (12.000), (223.00         ))
            , (('Y17'), (3), (12.000), (223.00         ))
            , (('Y17'), (4), (12.000), (223.00         ))
            , (('Y17'), (5), (12.000), (223.00         ))
            , (('Y21'), (1), (0.500), (470.00          ))
            , (('Y21'), (5), (0.500), (470.00          ))
            , (('Y21'), (4), (0.500), (470.00          ))
            , (('Y21'), (2), (0.500), (470.00          ))
            , (('Y21'), (3), (0.500), (470.00          ))
            , (('Y32'), (1), (1.000), (215.00          ))
            , (('Y32'), (2), (1.000), (215.00          ))
            , (('Y32'), (3), (1.000), (215.00          ))
            , (('Y32'), (4), (1.000), (215.00          ))
            , (('Y32'), (5), (1.000), (215.00          ))
    ) as hdd(WG, YEAR, FR, MC)
)
, HddCte2 as (
    select wg.Id as WgId, y.Id as YearId, h.*
    from HddCte h
    join InputAtoms.Wg wg on upper(Wg.Name) = upper(h.WG) 
    join Dependencies.Year y on y.Value = h.YEAR and y.IsProlongation = 0
)
update r set
      HddFr = h.FR
    , HddFr_Approved = h.FR
    , HddMaterialCost = h.MC
    , HddMaterialCost_Approved = h.MC
from Hardware.HddRetention r
join HddCte2 h on r.Wg = h.WgId and r.Year = h.YearId
