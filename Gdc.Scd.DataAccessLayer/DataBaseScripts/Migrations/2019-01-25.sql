declare @y1 bigint;
declare @y2 bigint;
declare @y3 bigint;
declare @y4 bigint;
declare @y5 bigint;

select @y1 = id from Dependencies.Year where Value = 1 and IsProlongation = 0;
select @y2 = id from Dependencies.Year where Value = 2 and IsProlongation = 0;
select @y3 = id from Dependencies.Year where Value = 3 and IsProlongation = 0;
select @y4 = id from Dependencies.Year where Value = 4 and IsProlongation = 0;
select @y5 = id from Dependencies.Year where Value = 5 and IsProlongation = 0;

with HddCte as (
    select *
    from (values
             (('BD6'), (0.35000), (0.35000), (0.35000), (0.35000), (0.35000), (148.00), (148.00), (148.00), (148.00), (148.00            ))
           , (('BD7'), (0.35000), (0.35000), (0.35000), (0.35000), (0.35000), (136.00), (136.00), (136.00), (136.00), (136.00            ))
           , (('BD8'), (0.26000), (0.26000), (0.26000), (0.26000), (0.26000), (121.00), (121.00), (121.00), (121.00), (121.00            ))
           , (('BD9'), (0.90000), (0.90000), (0.90000), (0.90000), (0.90000), (150.00), (150.00), (150.00), (150.00), (150.00            ))
           , (('C71'), (25.00000), (25.00000), (25.00000), (25.00000), (25.00000), (200.00), (200.00), (200.00), (200.00), (200.00       ))
           , (('C73'), (18.00000), (18.00000), (18.00000), (18.00000), (18.00000), (280.00), (280.00), (280.00), (280.00), (280.00       ))
           , (('C74'), (28.80000), (28.80000), (28.80000), (28.80000), (28.80000), (276.00), (276.00), (276.00), (276.00), (276.00       ))
           , (('C75'), (28.80000), (28.80000), (28.80000), (28.80000), (28.80000), (276.00), (276.00), (276.00), (276.00), (276.00       ))
           , (('C80'), (34.00000), (34.00000), (34.00000), (34.00000), (34.00000), (260.00), (260.00), (260.00), (260.00), (260.00       ))
           , (('C83'), (72.00000), (72.00000), (72.00000), (72.00000), (72.00000), (260.00), (260.00), (260.00), (260.00), (260.00       ))
           , (('C84'), (20.00000), (20.00000), (20.00000), (20.00000), (20.00000), (205.00), (205.00), (205.00), (205.00), (205.00       ))
           , (('C90'), (4.00000), (4.00000), (4.00000), (4.00000), (4.00000), (175.00), (175.00), (175.00), (175.00), (175.00            ))
           , (('C91'), (4.00000), (4.00000), (4.00000), (4.00000), (4.00000), (175.00), (175.00), (175.00), (175.00), (175.00            ))
           , (('C92'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (200.00), (200.00), (200.00), (200.00), (200.00       ))
           , (('C95'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (200.00), (200.00), (200.00), (200.00), (200.00       ))
           , (('C96'), (4.00000), (4.00000), (4.00000), (4.00000), (4.00000), (175.00), (175.00), (175.00), (175.00), (175.00            ))
           , (('C97'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (200.00), (200.00), (200.00), (200.00), (200.00       ))
           , (('C98'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (200.00), (200.00), (200.00), (200.00), (200.00       ))
           , (('CD5'), (90.00000), (90.00000), (90.00000), (90.00000), (90.00000), (294.15), (294.15), (294.15), (294.15), (294.15       ))
           , (('CD6'), (14.40000), (14.40000), (14.40000), (14.40000), (14.40000), (310.00), (310.00), (310.00), (310.00), (310.00       ))
           , (('CD7'), (14.30000), (14.30000), (14.30000), (14.30000), (14.30000), (290.00), (290.00), (290.00), (290.00), (290.00       ))
           , (('CD8'), (2.40000), (2.40000), (2.40000), (2.40000), (2.40000), (300.00), (300.00), (300.00), (300.00), (300.00            ))
           , (('CD9'), (2.40000), (2.40000), (2.40000), (2.40000), (2.40000), (300.00), (300.00), (300.00), (300.00), (300.00            ))
           , (('CS4'), (13.20000), (13.20000), (13.20000), (13.20000), (13.20000), (250.00), (250.00), (250.00), (250.00), (250.00       ))
           , (('CS7'), (28.80000), (28.80000), (28.80000), (28.80000), (28.80000), (257.00), (257.00), (257.00), (257.00), (257.00       ))
           , (('CS8'), (2.20000), (2.20000), (2.20000), (2.20000), (2.20000), (236.00), (236.00), (236.00), (236.00), (236.00            ))
           , (('CS9'), (80.00000), (80.00000), (80.00000), (80.00000), (80.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('F11'), (108.00000), (108.00000), (108.00000), (108.00000), (108.00000), (230.00), (230.00), (230.00), (230.00), (230.00  ))
           , (('F12'), (108.00000), (108.00000), (108.00000), (108.00000), (108.00000), (230.00), (230.00), (230.00), (230.00), (230.00  ))
           , (('F13'), (103.00000), (103.00000), (103.00000), (103.00000), (103.00000), (230.00), (230.00), (230.00), (230.00), (230.00  ))
           , (('F14'), (140.00000), (140.00000), (140.00000), (140.00000), (140.00000), (770.00), (770.00), (770.00), (770.00), (770.00  ))
           , (('F15'), (140.00000), (140.00000), (140.00000), (140.00000), (140.00000), (770.00), (770.00), (770.00), (770.00), (770.00  ))
           , (('F16'), (110.00000), (110.00000), (110.00000), (110.00000), (110.00000), (880.00), (880.00), (880.00), (880.00), (880.00  ))
           , (('F17'), (240.00000), (240.00000), (240.00000), (240.00000), (240.00000), (880.00), (880.00), (880.00), (880.00), (880.00  ))
           , (('F18'), (92.00000), (92.00000), (92.00000), (92.00000), (92.00000), (770.00), (770.00), (770.00), (770.00), (770.00       ))
           , (('F19'), (110.00000), (110.00000), (110.00000), (110.00000), (110.00000), (880.00), (880.00), (880.00), (880.00), (880.00  ))
           , (('F21'), (163.00000), (163.00000), (163.00000), (163.00000), (163.00000), (240.00), (240.00), (240.00), (240.00), (240.00  ))
           , (('F22'), (163.00000), (163.00000), (163.00000), (163.00000), (163.00000), (240.00), (240.00), (240.00), (240.00), (240.00  ))
           , (('F23'), (158.00000), (158.00000), (158.00000), (158.00000), (158.00000), (240.00), (240.00), (240.00), (240.00), (240.00  ))
           , (('F24'), (135.00000), (135.00000), (135.00000), (135.00000), (135.00000), (240.00), (240.00), (240.00), (240.00), (240.00  ))
           , (('F25'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (200.00), (200.00), (200.00), (200.00), (200.00       ))
           , (('F26'), (0.80000), (0.80000), (0.80000), (0.80000), (0.80000), (5000.00), (5000.00), (5000.00), (5000.00), (5000.00  ))
           , (('F27'), (0.80000), (0.80000), (0.80000), (0.80000), (0.80000), (5000.00), (5000.00), (5000.00), (5000.00), (5000.00  ))
           , (('F28'), (24.00000), (24.00000), (24.00000), (24.00000), (24.00000), (275.00), (275.00), (275.00), (275.00), (275.00       ))
           , (('F29'), (24.00000), (24.00000), (24.00000), (24.00000), (24.00000), (275.00), (275.00), (275.00), (275.00), (275.00       ))
           , (('F30'), (29.00000), (29.00000), (29.00000), (29.00000), (29.00000), (275.00), (275.00), (275.00), (275.00), (275.00       ))
           , (('F31'), (29.00000), (29.00000), (29.00000), (29.00000), (29.00000), (275.00), (275.00), (275.00), (275.00), (275.00       ))
           , (('F34'), (15.00000), (15.00000), (15.00000), (15.00000), (15.00000), (240.00), (240.00), (240.00), (240.00), (240.00       ))
           , (('F37'), (96.00000), (96.00000), (96.00000), (96.00000), (96.00000), (275.00), (275.00), (275.00), (275.00), (275.00       ))
           , (('F40'), (12.00000), (12.00000), (12.00000), (12.00000), (12.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('F41'), (80.00000), (80.00000), (80.00000), (80.00000), (80.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('F42'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('F43'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('F44'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('F45'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('F48'), (12.00000), (12.00000), (12.00000), (12.00000), (12.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('F49'), (80.00000), (80.00000), (80.00000), (80.00000), (80.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('F50'), (18.00000), (18.00000), (18.00000), (18.00000), (18.00000), (291.00), (291.00), (291.00), (291.00), (291.00       ))
           , (('F51'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('F52'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('F53'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (200.00), (200.00), (200.00), (200.00), (200.00       ))
           , (('F54'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (200.00), (200.00), (200.00), (200.00), (200.00       ))
           , (('F57'), (18.00000), (18.00000), (18.00000), (18.00000), (18.00000), (291.00), (291.00), (291.00), (291.00), (291.00       ))
           , (('MN2'), (9.00000), (9.00000), (9.00000), (9.00000), (9.00000), (185.00), (185.00), (185.00), (185.00), (185.00            ))
           , (('MN3'), (1.60000), (1.60000), (1.60000), (1.60000), (1.60000), (250.00), (250.00), (250.00), (250.00), (250.00            ))
           , (('MS1'), (1.93000), (1.93000), (1.93000), (1.93000), (1.93000), (102.00), (102.00), (102.00), (102.00), (102.00            ))
           , (('MS2'), (1.15000), (1.15000), (1.15000), (1.15000), (1.15000), (102.00), (102.00), (102.00), (102.00), (102.00            ))
           , (('NB1'), (0.60000), (0.60000), (0.60000), (0.60000), (0.60000), (125.00), (125.00), (125.00), (125.00), (125.00            ))
           , (('NB2'), (0.42000), (0.42000), (0.42000), (0.42000), (0.42000), (115.00), (115.00), (115.00), (115.00), (115.00            ))
           , (('NB3'), (0.42000), (0.42000), (0.42000), (0.42000), (0.42000), (204.00), (204.00), (204.00), (204.00), (204.00            ))
           , (('NB4'), (1.50000), (1.50000), (1.50000), (1.50000), (1.50000), (131.00), (131.00), (131.00), (131.00), (131.00            ))
           , (('NB5'), (1.10000), (1.10000), (1.10000), (1.10000), (1.10000), (110.00), (110.00), (110.00), (110.00), (110.00            ))
           , (('NB6'), (0.65000), (0.65000), (0.65000), (0.65000), (0.65000), (69.00), (69.00), (69.00), (69.00), (69.00                 ))
           , (('NB7'), (1.00000), (1.00000), (1.00000), (1.00000), (1.00000), (83.00), (83.00), (83.00), (83.00), (83.00                 ))
           , (('NB8'), (1.40000), (1.40000), (1.40000), (1.40000), (1.40000), (103.00), (103.00), (103.00), (103.00), (103.00            ))
           , (('NB9'), (0.90000), (0.90000), (0.90000), (0.90000), (0.90000), (110.00), (110.00), (110.00), (110.00), (110.00            ))
           , (('NBH'), (0.40000), (0.40000), (0.40000), (0.40000), (0.40000), (160.00), (160.00), (160.00), (160.00), (160.00            ))
           , (('NBL'), (0.42000), (0.42000), (0.42000), (0.42000), (0.42000), (140.00), (140.00), (140.00), (140.00), (140.00            ))
           , (('NBS'), (0.77000), (0.77000), (0.77000), (0.77000), (0.77000), (140.00), (140.00), (140.00), (140.00), (140.00            ))
           , (('NC1'), (0.42000), (0.42000), (0.42000), (0.42000), (0.42000), (190.00), (190.00), (190.00), (190.00), (190.00            ))
           , (('NC2'), (2.40000), (2.40000), (2.40000), (2.40000), (2.40000), (120.00), (120.00), (120.00), (120.00), (120.00            ))
           , (('NC3'), (0.38000), (0.38000), (0.38000), (0.38000), (0.38000), (168.00), (168.00), (168.00), (168.00), (168.00            ))
           , (('NC5'), (2.70000), (2.70000), (2.70000), (2.70000), (2.70000), (91.00), (91.00), (91.00), (91.00), (91.00                 ))
           , (('NC9'), (0.20000), (0.20000), (0.20000), (0.20000), (0.20000), (228.00), (228.00), (228.00), (228.00), (228.00            ))
           , (('NME'), (0.68000), (0.68000), (0.68000), (0.68000), (0.68000), (153.00), (153.00), (153.00), (153.00), (153.00            ))
           , (('NML'), (0.81000), (0.81000), (0.81000), (0.81000), (0.81000), (160.00), (160.00), (160.00), (160.00), (160.00            ))
           , (('NXL'), (0.95000), (0.95000), (0.95000), (0.95000), (0.95000), (145.00), (145.00), (145.00), (145.00), (145.00            ))
           , (('PB7'), (3.20000), (3.20000), (3.20000), (3.20000), (3.20000), (180.00), (180.00), (180.00), (180.00), (180.00            ))
           , (('PQ0'), (10.00000), (10.00000), (10.00000), (10.00000), (10.00000), (747.00), (747.00), (747.00), (747.00), (747.00       ))
           , (('PQ5'), (4.50000), (4.50000), (4.50000), (4.50000), (4.50000), (350.00), (350.00), (350.00), (350.00), (350.00            ))
           , (('PQ9'), (11.00000), (11.00000), (11.00000), (11.00000), (11.00000), (688.00), (688.00), (688.00), (688.00), (688.00       ))
           , (('PS3'), (26.00000), (26.00000), (26.00000), (26.00000), (26.00000), (500.00), (500.00), (500.00), (500.00), (500.00       ))
           , (('PX1'), (1.60000), (1.60000), (1.60000), (1.60000), (1.60000), (162.00), (162.00), (162.00), (162.00), (162.00            ))
           , (('PX2'), (2.00000), (2.00000), (2.00000), (2.00000), (2.00000), (210.00), (210.00), (210.00), (210.00), (210.00            ))
           , (('PX3'), (3.50000), (3.50000), (3.50000), (3.50000), (3.50000), (210.00), (210.00), (210.00), (210.00), (210.00            ))
           , (('PX6'), (5.00000), (5.00000), (5.00000), (5.00000), (5.00000), (220.00), (220.00), (220.00), (220.00), (220.00            ))
           , (('PX7'), (1.55000), (1.55000), (1.55000), (1.55000), (1.55000), (400.00), (400.00), (400.00), (400.00), (400.00            ))
           , (('PX8'), (7.51000), (7.51000), (7.51000), (7.51000), (7.51000), (235.00), (235.00), (235.00), (235.00), (235.00            ))
           , (('PXL'), (2.00000), (2.00000), (2.00000), (2.00000), (2.00000), (145.00), (145.00), (145.00), (145.00), (145.00            ))
           , (('PXS'), (2.10000), (2.10000), (2.10000), (2.10000), (2.10000), (180.00), (180.00), (180.00), (180.00), (180.00            ))
           , (('PY1'), (3.00000), (3.00000), (3.00000), (3.00000), (3.00000), (170.00), (170.00), (170.00), (170.00), (170.00            ))
           , (('PY2'), (5.50000), (5.50000), (5.50000), (5.50000), (5.50000), (195.00), (195.00), (195.00), (195.00), (195.00            ))
           , (('PY3'), (11.00000), (11.00000), (11.00000), (11.00000), (11.00000), (235.00), (235.00), (235.00), (235.00), (235.00       ))
           , (('PY4'), (3.50000), (3.50000), (3.50000), (3.50000), (3.50000), (175.00), (175.00), (175.00), (175.00), (175.00            ))
           , (('PZ2'), (4.30000), (4.30000), (4.30000), (4.30000), (4.30000), (180.00), (180.00), (180.00), (180.00), (180.00            ))
           , (('RB0'), (0.30000), (0.30000), (0.30000), (0.30000), (0.30000), (75.00), (75.00), (75.00), (75.00), (75.00                 ))
           , (('SB2'), (3.00000), (3.00000), (3.00000), (3.00000), (3.00000), (150.00), (150.00), (150.00), (150.00), (150.00            ))
           , (('SB3'), (4.00000), (4.00000), (4.00000), (4.00000), (4.00000), (165.00), (165.00), (165.00), (165.00), (165.00            ))
           , (('TR7'), (0.20000), (0.20000), (0.20000), (0.20000), (0.20000), (300.00), (300.00), (300.00), (300.00), (300.00            ))
           , (('U01'), (0.41000), (0.41000), (0.41000), (0.41000), (0.41000), (75.00), (75.00), (75.00), (75.00), (75.00                 ))
           , (('U02'), (0.26000), (0.26000), (0.26000), (0.26000), (0.26000), (77.00), (77.00), (77.00), (77.00), (77.00                 ))
           , (('U03'), (0.38000), (0.38000), (0.38000), (0.38000), (0.38000), (80.00), (80.00), (80.00), (80.00), (80.00                 ))
           , (('U04'), (0.60000), (0.60000), (0.60000), (0.60000), (0.60000), (89.00), (89.00), (89.00), (89.00), (89.00                 ))
           , (('U06'), (0.32000), (0.32000), (0.32000), (0.32000), (0.32000), (80.00), (80.00), (80.00), (80.00), (80.00                 ))
           , (('U07'), (0.70000), (0.70000), (0.70000), (0.70000), (0.70000), (74.00), (74.00), (74.00), (74.00), (74.00                 ))
           , (('U08'), (0.53000), (0.53000), (0.53000), (0.53000), (0.53000), (100.00), (100.00), (100.00), (100.00), (100.00            ))
           , (('U09'), (0.70000), (0.70000), (0.70000), (0.70000), (0.70000), (65.00), (65.00), (65.00), (65.00), (65.00                 ))
           , (('U10'), (0.35000), (0.35000), (0.35000), (0.35000), (0.35000), (75.00), (75.00), (75.00), (75.00), (75.00                 ))
           , (('U11'), (0.50000), (0.50000), (0.50000), (0.50000), (0.50000), (73.00), (73.00), (73.00), (73.00), (73.00                 ))
           , (('U12'), (0.26000), (0.26000), (0.26000), (0.26000), (0.26000), (77.00), (77.00), (77.00), (77.00), (77.00                 ))
           , (('U13'), (0.24000), (0.24000), (0.24000), (0.24000), (0.24000), (92.00), (92.00), (92.00), (92.00), (92.00                 ))
           , (('W01'), (0.60000), (0.60000), (0.60000), (0.60000), (0.60000), (180.00), (180.00), (180.00), (180.00), (180.00            ))
           , (('WRC'), (0.55000), (0.55000), (0.55000), (0.55000), (0.55000), (100.00), (100.00), (100.00), (100.00), (100.00            ))
           , (('WSJ'), (0.30000), (0.30000), (0.30000), (0.30000), (0.30000), (138.00), (138.00), (138.00), (138.00), (138.00            ))
           , (('WSN'), (0.45000), (0.45000), (0.45000), (0.45000), (0.45000), (125.00), (125.00), (125.00), (125.00), (125.00            ))
           , (('WSS'), (0.90000), (0.90000), (0.90000), (0.90000), (0.90000), (145.00), (145.00), (145.00), (145.00), (145.00            ))
           , (('WSW'), (0.55000), (0.55000), (0.55000), (0.55000), (0.55000), (105.00), (105.00), (105.00), (105.00), (105.00            ))
           , (('Y02'), (1.80000), (1.80000), (1.80000), (1.80000), (1.80000), (200.00), (200.00), (200.00), (200.00), (200.00            ))
           , (('Y03'), (0.50000), (0.50000), (0.50000), (0.50000), (0.50000), (260.00), (260.00), (260.00), (260.00), (260.00            ))
           , (('Y04'), (3.44000), (3.44000), (3.44000), (3.44000), (3.44000), (240.00), (240.00), (240.00), (240.00), (240.00            ))
           , (('Y09'), (1.50000), (1.50000), (1.50000), (1.50000), (1.50000), (170.00), (170.00), (170.00), (170.00), (170.00            ))
           , (('Y12'), (0.60000), (0.60000), (0.60000), (0.60000), (0.60000), (115.00), (115.00), (115.00), (115.00), (115.00            ))
           , (('Y17'), (12.00000), (12.00000), (12.00000), (12.00000), (12.00000), (223.00), (223.00), (223.00), (223.00), (223.00       ))
           , (('Y21'), (0.50000), (0.50000), (0.50000), (0.50000), (0.50000), (470.00), (470.00), (470.00), (470.00), (470.00            ))
           , (('Y22'), (12.24000), (12.24000), (12.24000), (12.24000), (12.24000), (136.94), (136.94), (136.94), (136.94), (136.94       ))
           , (('Y23'), (6.50000), (6.50000), (6.50000), (6.50000), (6.50000), (853.00), (853.00), (853.00), (853.00), (853.00            ))
           , (('Y32'), (1.00000), (1.00000), (1.00000), (1.00000), (1.00000), (215.00), (215.00), (215.00), (215.00), (215.00            ))
           , (('R0A'), (0.30000), (0.30000), (0.30000), (0.30000), (0.30000), (75.00), (75.00), (75.00), (75.00), (75.00                 ))
           , (('S9B'), (3.00000), (3.00000), (3.00000), (3.00000), (3.00000), (150.00), (150.00), (150.00), (150.00), (150.00            ))
           , (('S9C'), (4.00000), (4.00000), (4.00000), (4.00000), (4.00000), (165.00), (165.00), (165.00), (165.00), (165.00            ))
           , (('S8A'), (25.00000), (25.00000), (25.00000), (25.00000), (25.00000), (200.00), (200.00), (200.00), (200.00), (200.00       ))
           , (('S8B'), (18.00000), (18.00000), (18.00000), (18.00000), (18.00000), (280.00), (280.00), (280.00), (280.00), (280.00       ))
           , (('S0B'), (28.80000), (28.80000), (28.80000), (28.80000), (28.80000), (269.38), (269.38), (269.38), (269.38), (269.38       ))
           , (('S8C'), (34.00000), (34.00000), (34.00000), (34.00000), (34.00000), (260.00), (260.00), (260.00), (260.00), (260.00       ))
           , (('S8D'), (20.00000), (20.00000), (20.00000), (20.00000), (20.00000), (205.00), (205.00), (205.00), (205.00), (205.00       ))
           , (('S2A'), (4.00000), (4.00000), (4.00000), (4.00000), (4.00000), (175.00), (175.00), (175.00), (175.00), (175.00            ))
           , (('S2B'), (17.00000), (17.00000), (17.00000), (17.00000), (17.00000), (200.00), (200.00), (200.00), (200.00), (200.00       ))
           , (('D1C'), (14.40000), (14.40000), (14.40000), (14.40000), (14.40000), (310.00), (310.00), (310.00), (310.00), (310.00       ))
           , (('D1D'), (14.30000), (14.30000), (14.30000), (14.30000), (14.30000), (290.00), (290.00), (290.00), (290.00), (290.00       ))
           , (('D1E'), (2.40000), (2.40000), (2.40000), (2.40000), (2.40000), (300.00), (300.00), (300.00), (300.00), (300.00            ))
           , (('S0F'), (13.20000), (13.20000), (13.20000), (13.20000), (13.20000), (250.00), (250.00), (250.00), (250.00), (250.00       ))
           , (('S0A'), (2.20000), (2.20000), (2.20000), (2.20000), (2.20000), (236.00), (236.00), (236.00), (236.00), (236.00            ))
           , (('S0H'), (80.00000), (80.00000), (80.00000), (80.00000), (80.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('ST5'), (24.00000), (24.00000), (24.00000), (24.00000), (24.00000), (275.00), (275.00), (275.00), (275.00), (275.00       ))
           , (('ST1'), (12.27974), (12.27974), (12.27974), (12.27974), (12.27974), (318.01), (318.01), (318.01), (318.01), (318.01       ))
           , (('ST2'), (80.00000), (80.00000), (80.00000), (80.00000), (80.00000), (325.00), (325.00), (325.00), (325.00), (325.00       ))
           , (('ST3'), (17.00651), (17.00651), (17.00651), (17.00651), (17.00651), (324.78), (324.78), (324.78), (324.78), (324.78       ))
           , (('SV2'), (4.07169), (4.07169), (4.07169), (4.07169), (4.07169), (222.67), (222.67), (222.67), (222.67), (222.67            ))
           , (('MB2'), (0.65451), (0.65451), (0.65451), (0.65451), (0.65451), (113.36), (113.36), (113.36), (113.36), (113.36            ))
           , (('MB1'), (0.68141), (0.68141), (0.68141), (0.68141), (0.68141), (70.26), (70.26), (70.26), (70.26), (70.26                 ))
           , (('MB3'), (0.38973), (0.38973), (0.38973), (0.38973), (0.38973), (173.35), (173.35), (173.35), (173.35), (173.35            ))
           , (('MB4'), (0.20000), (0.20000), (0.20000), (0.20000), (0.20000), (237.66), (237.66), (237.66), (237.66), (237.66            ))
           , (('SVQ'), (4.50000), (4.50000), (4.50000), (4.50000), (4.50000), (350.00), (350.00), (350.00), (350.00), (350.00            ))
           , (('SV1'), (1.79946), (1.79946), (1.79946), (1.79946), (1.79946), (149.04), (149.04), (149.04), (149.04), (149.04            ))
           , (('SV4'), (5.00000), (5.00000), (5.00000), (5.00000), (5.00000), (220.00), (220.00), (220.00), (220.00), (220.00            ))
           , (('DT6'), (0.29707), (0.29707), (0.29707), (0.29707), (0.29707), (74.28), (74.28), (74.28), (74.28), (74.28                 ))
           , (('DT5'), (0.46753), (0.46753), (0.46753), (0.46753), (0.46753), (93.52), (93.52), (93.52), (93.52), (93.52                 ))
           , (('DT7'), (0.55000), (0.55000), (0.55000), (0.55000), (0.55000), (100.00), (100.00), (100.00), (100.00), (100.00            ))
           , (('ST9'), (18.00000), (18.00000), (18.00000), (18.00000), (18.00000), (320.00), (320.00), (320.00), (320.00), (320.00       ))
        ) as hdd(WG, FR1, FR2, FR3, FR4, FR5, MC1, MC2, MC3, MC4, MC5)
)
, HddCte2 as (
    select wg.Id as WgId, h.*
    from HddCte h
    join InputAtoms.Wg wg on upper(Wg.Name) = upper(h.WG) 
)
update r set
       HddFr =  case 
                    when r.Year = @y1 then h.FR1
                    when r.Year = @y2 then h.FR2
                    when r.Year = @y3 then h.FR3
                    when r.Year = @y4 then h.FR4
                    when r.Year = @y5 then h.FR5
                end

     , HddFr_Approved =  case 
                    when r.Year = @y1 then h.FR1
                    when r.Year = @y2 then h.FR2
                    when r.Year = @y3 then h.FR3
                    when r.Year = @y4 then h.FR4
                    when r.Year = @y5 then h.FR5
                end

     , HddMaterialCost = case 
                    when r.Year = @y1 then h.MC1
                    when r.Year = @y2 then h.MC2
                    when r.Year = @y3 then h.MC3
                    when r.Year = @y4 then h.MC4
                    when r.Year = @y5 then h.MC5
                end
     , HddMaterialCost_Approved = case 
                    when r.Year = @y1 then h.MC1
                    when r.Year = @y2 then h.MC2
                    when r.Year = @y3 then h.MC3
                    when r.Year = @y4 then h.MC4
                    when r.Year = @y5 then h.MC5
                end

from Hardware.HddRetention r
join HddCte2 h on r.Wg = h.WgId
where r.Year in (@y1, @y2, @y3, @y4, @y5)